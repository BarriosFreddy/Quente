import{r as s,u as M,c as w,j as t}from"./index-zLCb2fgV.js";import{P as b}from"./DefaultLayout-Dp8_4Mli.js";import{D,a7 as O,E as I,K as P,M as v,V as H,Z as $,X as G,_ as K,O as U,b as W,a0 as X,a3 as Z}from"./index.esm-CGtd4b9a.js";import{c as _}from"./cil-plus-DmDyxMpI.js";import{g as q,C as A,a as y}from"./Clients-DVxdOLBe.js";const J=s.forwardRef(function(n,k){const a=M(),m=w(e=>e.clients.clients),C=w(e=>e.clients.client);let[l,o]=s.useState(null);const i=s.useRef(),r=s.useRef(),[u,d]=s.useState(!1),[f,p]=s.useState(!1),[x,N]=s.useState("");let[E,c]=s.useState(!1);s.useEffect(()=>{n.defaultValue&&a(q(n.defaultValue))},[a,n.defaultValue]),s.useEffect(()=>{o(C)},[C]),s.useEffect(()=>{function e(h){r.current&&!r.current.contains(h.target)&&d(!1)}return u&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[u]),s.useImperativeHandle(k,()=>({getSelected(){return l},setSelected(e){o(e)},clear(){o(null)}}),[l]);const F=({target:{value:e}})=>{N(e),a(y({dni:e}))},S=()=>{d(!0)},R=S,L=e=>{p(!1),d(!1),o(e),n.onSelect&&n.onSelect(e)},g=()=>{p(!0),setImmediate(()=>{i.current?.focus()}),a(y({dni:x}))},T=g,j=e=>e?`${e?.name||""} (${e?.dni||""})`:"",V=()=>{c(!0)},z=()=>{c(!1)},B=()=>{c(!1)};return t.jsxs(t.Fragment,{children:[t.jsxs(D,{ref:r,children:[t.jsx(O,{htmlFor:"searchInput",className:"col-sm-2 col-form-label d-none d-md-block",children:"Cliente:"}),t.jsxs(I,{children:[t.jsxs(P,{children:[f&&t.jsx(v,{id:"searchInput",ref:i,type:"text",formNoValidate:!0,size:"sm",value:x,placeholder:"Seleccione un cliente...",onChange:e=>F(e),onClick:S,onFocus:R}),!f&&t.jsx(v,{type:"text",formNoValidate:!0,size:"sm",placeholder:"Seleccione un cliente...",value:j(l),readOnly:!0,onClick:g,onFocus:T})]}),u&&t.jsx("div",{className:"client-list",style:{maxHeight:150,width:i.current?.offsetWidth||200},children:t.jsx(H,{hover:!0,small:!0,borderless:!0,style:{marginBottom:0},children:t.jsxs($,{children:[m.map((e,h)=>t.jsx(G,{active:l&&l.dni===e.dni,onClick:()=>L(e),children:t.jsx(K,{children:j(e)})},h)),m.length<=0&&"Loading..."]})})})]}),t.jsx(I,{lg:"2",children:t.jsxs(U,{size:"sm",variant:"outline",color:"success",onClick:V,children:[t.jsx(W,{icon:_,size:"sm"}),"NUEVO"]})})]}),t.jsx(X,{size:"lg",backdrop:"static",visible:E,onClose:()=>c(!1),children:t.jsx(Z,{style:{padding:0},children:t.jsx(A,{isPopup:!0,onCancel:z,onSave:B})})})]})});J.propTypes={onSelect:b.func,defaultValue:b.string};export{J as C};
