import{u as S,c as I,r as h,U as w,j as s}from"./index-zLCb2fgV.js";import{t as k,H as m,P as E,R as F,I as j,D as f,E as n,M as H,O as M,V as A,W as B,X as b,Y as t,Z as O,_ as i,$ as U}from"./index.esm-CGtd4b9a.js";import{d as L}from"./DefaultLayout-Dp8_4Mli.js";import{f as P}from"./index-CR_XkoXS.js";import{H as _}from"./Helmet-C40K-Xy2.js";import{s as G}from"./notification.service-CZX6zi9-.js";import{u as V}from"./useDidUpdate--HUzPQat.js";import"./cil-user-Cc0HYXzm.js";import"./SyncService-CJenB6tV.js";import"./DatabaseService-IbC6Bkt9.js";import"./dayjs.min-Bvy1Uf3G.js";const q=5242880;function as(){const o=S(),g=I(a=>a.items.saveSuccess);let[d,x]=h.useState([]),[u,p]=h.useState(null);const v=h.useCallback(()=>{G({message:"Carga de datos exitosa",color:"success"}),o(w(!1)),x([])},[o]);V(()=>{v()},[g]);const N=({target:a})=>{const r=a.files[0],{size:c,type:l}=r;if(l!=="text/csv"){p("El archivo debe ser tipo CSV");return}if(c>q){p("El archivo no debe superar los 5 Megabytes");return}const e=new FileReader;e.readAsText(r),e.onloadend=()=>D(e.result),e.onerror=C=>{console.log(e.result)}},D=a=>{x([]);const r=a.split(/\n/);r.shift();const c=r.filter(l=>l.length>0).map(l=>{const e=l.split(",");return{code:e[0],name:e[1],description:e[2],price:e[3],units:e[4],measurementUnit:e[5],expirationDate:e[6],laboratory:e[7]}});x(c)},T=async()=>{o(L(d))};return s.jsx(s.Fragment,{children:s.jsx(k,{className:"mt--6",fluid:!0,children:s.jsxs(m,{className:"shadow border-10",children:[s.jsxs(E,{className:"border-0",children:[s.jsx(_,{children:s.jsx("title",{children:"MIGRADOR DE DATOS"})}),s.jsx(F,{children:"MIGRADOR DE DATOS"})]}),s.jsx(j,{children:s.jsxs(s.Fragment,{children:[s.jsx(m,{style:{width:"auto"},children:s.jsxs(j,{children:[s.jsxs(f,{children:[s.jsx(n,{xs:"12",children:s.jsx("div",{className:"mb-3",children:s.jsx(H,{type:"file",id:"formFile",label:"Cargar datos",onChange:N,feedbackInvalid:u,invalid:!!u,required:!0})})}),s.jsx(n,{xs:"12",children:s.jsx(M,{color:"success",type:"button",disabled:d.length<=0,onClick:T,children:"Cargar datos"})})]}),s.jsx("div",{className:"d-lg-none",children:d.map(({code:a,name:r,description:c,units:l})=>s.jsx(m,{className:"shadow mt-1",children:s.jsx(j,{children:s.jsxs(f,{children:[s.jsx(n,{xs:"12",className:"text-uppercase",children:r}),s.jsx(n,{className:"fs-6",xs:"12",children:a}),s.jsx(n,{xs:"12",className:"text-break",children:c}),s.jsx(n,{xs:"12",children:l})]})})},a))}),s.jsx("div",{className:"d-none d-lg-block",children:s.jsxs(A,{small:!0,hover:!0,children:[s.jsx(B,{children:s.jsxs(b,{children:[s.jsx(t,{children:"Nombre"}),s.jsx(t,{children:"Código"}),s.jsx(t,{children:"Descripción"}),s.jsx(t,{children:"Precio"}),s.jsx(t,{children:"Unidades"}),s.jsx(t,{children:"Uniad de medida"}),s.jsx(t,{children:"Fecha de vencimiento"}),s.jsx(t,{children:"Laboratorio"})]})}),s.jsx(O,{children:d.map(({code:a,name:r,description:c,price:l,units:e,measurementUnit:C,expirationDate:y,laboratory:R})=>s.jsxs(b,{children:[s.jsx(i,{xs:"12",className:"text-uppercase",children:r}),s.jsx(i,{className:"fs-6",xs:"12",children:a}),s.jsx(i,{xs:"12",className:"text-break",children:c}),s.jsx(i,{xs:"12",children:P(l)}),s.jsx(i,{xs:"12",children:e}),s.jsx(i,{xs:"12",children:C}),s.jsx(i,{xs:"12",children:y}),s.jsx(i,{xs:"12",children:R})]},a))})]})})]})}),s.jsx(U,{className:"py-4",children:s.jsx(n,{})})]})})]})})})}export{as as default};
